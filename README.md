# Лабораторная работа №1  
## Выбор начальных условий

## 1. Датасет для задачи классификации

**Название датасета:** Mushroom Dataset

**Краткое описание задачи:**  
Рассматривается задача бинарной классификации: по описанию внешних и некоторых внутренних характеристик гриба необходимо определить, является ли он съедобным или ядовитым. Датасет основан на описаниях грибов семейств *Agaricus* и *Lepiota* и содержит структурированные признаки, используемые в микологии

**Структура данных:**  
- Объекты: записи о отдельных грибах (несколько тысяч наблюдений)
- Целевая переменная: класс гриба — съедобный или ядовитый (включая грибы с неизвестной безопасностью, которые также считаются «опасными» в целях задачи)
- Признаки: только категориальные — форма и поверхность шляпки, цвет шляпки, запах, характеристики пластинок (цвет, ширина, частота), параметры ножки (длина, толщина, наличие и тип кольца, корень), цвет спорового порошка, тип среды обитания и др

**Обоснование выбора как реальной практической задачи:**  
- Определение съедобности гриба по внешним признакам — прикладная задача, напрямую связанная с безопасностью человека (риск отравления при неверной классификации). По данным Роспотребнадзора, в России каждый год происходит более тысячи таких случаев, около 30 человек спасти не удается.
- Модель на основе этого датасета можно рассматривать как прототип системы поддержки принятия решений для грибников, врачей или специалистов по биобезопасности 
- Наличие большого числа категориальных признаков делает датасет подходящим для демонстрации методов кодирования признаков, анализа важности признаков и сравнительного исследования алгоритмов классификации, в том числе KNN

## 2. Датасет для задачи регрессии

**Название датасета:** Spotify Dataset  

**Краткое описание задачи:**  
Рассматривается задача регрессии: по аудио‑ и метаданным трека требуется предсказать его популярность в Spotify. Целевая переменная — популярность трека, выраженная числом от 0 до 100, которое агрегирует поведение пользователей (прослушивания, добавления в плейлисты, пропуски и др.)  

**Структура данных:**  
- Объекты: музыкальные треки (десятки тысяч записей).  
- Целевая переменная: `popularity` — целое значение в диапазоне 0–100.  
- Признаки:  
  - Аудиофичи: `danceability`, `energy`, `loudness`, `speechiness`, `acousticness`, `instrumentalness`, `liveness`, `valence`, `tempo` и др.  
  - Музыкально‑структурные характеристики: тональность (key), лад (mode), размер (time_signature).  
  - Метаданные: жанр трека, год выпуска, флаг явного контента (explicit), а также дополнительные инженерные признаки, отражающие настроение и интенсивность трека.  

**Обоснование выбора как реальной практической задачи:**  
- Задача предсказания популярности треков является типичным кейсом для стриминговых сервисов и музыкальных платформ, где необходимо ранжировать треки, строить рекомендательные системы и планировать промокампании.  
- Целевая переменная основана на реальном пользовательском поведении, что позволяет интерпретировать модель в терминах влияния различных аудиохарактеристик на успех трека.  
- Датасет содержит как числовые, так и категориальные признаки, что делает его удобным для демонстрации полного цикла обработки данных: от предобработки до построения и сравнения моделей регрессии, включая KNN.  

## 3. Выбор метрик качества и их обоснование

### 3.1. Метрики качества для классификации (датасет грибов)

Для оценки качества модели KNN и последующих алгоритмов на задаче классификации съедобности грибов используются:  

- **Accuracy**  
  Показывает общий процент правильно определённых грибов. Удобная базовая метрика для первичного сравнения моделей.  

- **Precision и Recall для класса ядовитых**  
  - Precision (точность) для класса «ядовитый» показывает, какая доля грибов, предсказанных моделью как ядовитые, действительно являются ядовитыми. Это важно, чтобы не давать слишком много ложных тревог.  
  - Recall (полнота) для класса «ядовитый» показывает, какую долю реально ядовитых грибов модель сумела найти. Эта метрика особенно важна, так как пропуск ядовитого гриба может иметь серьёзные последствия.  

- **F1‑score для класса ядовитых**  
  F1‑мера является гармоническим средним Precision и Recall и позволяет сбалансированно оценивать качество модели в условиях, когда ошибки разных типов (ложноположительные и ложноотрицательные) имеют разную «цену».  

При необходимости также может использоваться **ROC‑AUC**, чтобы оценить качество вероятностного ранжирования объектов по принадлежности к классу ядовитых

### 3.2. Метрики качества для регрессии (датасет Spotify)

Для оценки качества моделей регрессии, предсказывающих популярность трека, предлагается использовать:  

- **MAE**  
  Средняя абсолютная ошибка показывает, насколько в среднем (в пунктах шкалы 0–100) предсказанная популярность трека отличается от реальной. Метрика легко интерпретируется: «модель в среднем ошибается на N единиц популярности»

- **RMSE**  
  Корень из среднеквадратичной ошибки сильнее штрафует крупные ошибки, чем MAE. Подходит, если важно минимизировать большие отклонения предсказаний, например, когда сильно ошибаться по очень популярным или очень непопулярным трекам особенно нежелательно

- **\(R^2\)**  
  Показывает долю дисперсии целевой переменной, объясняемую моделью. Значения, близкие к 1, соответствуют хорошему качеству, значения около 0 говорят о том, что модель почти не лучше константного предсказания среднего значения

Совместное использование MAE, RMSE и \(R^2\) позволяет оценить качество моделей как в «абсолютных» единицах (ошибка в баллах популярности), так и в «относительных» (насколько хорошо модель объясняет вариацию популярности по сравнению с простыми базовыми подходами)
